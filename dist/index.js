(()=>{var e={183:function(e,t,n){var r,a,o;e=n.nmd(e),function(s,i,c){"use strict";var l={function:!0,object:!0},u=l[typeof t]&&t&&!t.nodeType&&t,f=l.object&&e&&!e.nodeType&&e,p=u&&f&&"object"==typeof n.g&&n.g,h=f&&f.exports===u&&u;!p||p.global!==p&&p.window!==p&&p.self,a=[t],void 0===(o="function"==typeof(r=c)?r.apply(t,a):r)||(e.exports=o),u&&h&&c(f.exports)}(0,0,(function(e){"use strict";var t,n,r,a,o;e.version="0.3.1";var s=e.defaultOptions={wait:!1,comments:!0,scope:!1,locations:!1,ranges:!1,onCreateNode:null,onCreateScope:null,onDestroyScope:null,onLocalDeclaration:null,luaVersion:"5.1",encodingMode:"none"};function i(e,t){return t=t||0,e<128?String.fromCharCode(e):e<2048?String.fromCharCode(192|t|e>>6,128|t|63&e):e<65536?String.fromCharCode(224|t|e>>12,128|t|e>>6&63,128|t|63&e):e<1114112?String.fromCharCode(240|t|e>>18,128|t|e>>12&63,128|t|e>>6&63,128|t|63&e):null}function c(e){return function(t){var n=e.exec(t);if(!n)return t;D(null,y.invalidCodeUnit,function(e){for(var t=e.toString(16);t.length<4;)t="0"+t;return t}(n[0].charCodeAt(0)).toUpperCase())}}var l={"pseudo-latin1":{fixup:c(/[^\x00-\xff]/),encodeByte:function(e){return null===e?"":String.fromCharCode(e)},encodeUTF8:function(e){return i(e)}},"x-user-defined":{fixup:c(/[^\x00-\x7f\uf780-\uf7ff]/),encodeByte:function(e){return null===e?"":e>=128?String.fromCharCode(63232|e):String.fromCharCode(e)},encodeUTF8:function(e){return i(e,63232)}},none:{discardStrings:!0,fixup:function(e){return e},encodeByte:function(e){return""},encodeUTF8:function(e){return""}}},u=1,f=2,p=4,h=8,d=16,g=32,b=64,m=128,v=256;e.tokenTypes={EOF:u,StringLiteral:f,Keyword:p,Identifier:h,NumericLiteral:d,Punctuator:g,BooleanLiteral:b,NilLiteral:m,VarargLiteral:v};var y=e.errors={unexpected:"unexpected %1 '%2' near '%3'",unexpectedEOF:"unexpected symbol near '<eof>'",expected:"'%1' expected near '%2'",expectedToken:"%1 expected near '%2'",unfinishedString:"unfinished string near '%1'",malformedNumber:"malformed number near '%1'",decimalEscapeTooLarge:"decimal escape too large near '%1'",invalidEscape:"invalid escape sequence near '%1'",hexadecimalDigitExpected:"hexadecimal digit expected near '%1'",braceExpected:"missing '%1' near '%2'",tooLargeCodepoint:"UTF-8 value too large near '%1'",unfinishedLongString:"unfinished long string (starting at line %1) near '%2'",unfinishedLongComment:"unfinished long comment (starting at line %1) near '%2'",ambiguousSyntax:"ambiguous syntax (function call x new statement) near '%1'",noLoopToBreak:"no loop to break near '%1'",labelAlreadyDefined:"label '%1' already defined on line %2",labelNotVisible:"no visible label '%1' for <goto>",gotoJumpInLocalScope:"<goto %1> jumps into the scope of local '%2'",cannotUseVararg:"cannot use '...' outside a vararg function near '%1'",invalidCodeUnit:"code unit U+%1 is not allowed in the current encoding mode"},x=e.ast={labelStatement:function(e){return{type:"LabelStatement",label:e}},breakStatement:function(){return{type:"BreakStatement"}},gotoStatement:function(e){return{type:"GotoStatement",label:e}},returnStatement:function(e){return{type:"ReturnStatement",arguments:e}},ifStatement:function(e){return{type:"IfStatement",clauses:e}},ifClause:function(e,t){return{type:"IfClause",condition:e,body:t}},elseifClause:function(e,t){return{type:"ElseifClause",condition:e,body:t}},elseClause:function(e){return{type:"ElseClause",body:e}},whileStatement:function(e,t){return{type:"WhileStatement",condition:e,body:t}},doStatement:function(e){return{type:"DoStatement",body:e}},repeatStatement:function(e,t){return{type:"RepeatStatement",condition:e,body:t}},localStatement:function(e,t){return{type:"LocalStatement",variables:e,init:t}},assignmentStatement:function(e,t){return{type:"AssignmentStatement",variables:e,init:t}},callStatement:function(e){return{type:"CallStatement",expression:e}},functionStatement:function(e,t,n,r){return{type:"FunctionDeclaration",identifier:e,isLocal:n,parameters:t,body:r}},forNumericStatement:function(e,t,n,r,a){return{type:"ForNumericStatement",variable:e,start:t,end:n,step:r,body:a}},forGenericStatement:function(e,t,n){return{type:"ForGenericStatement",variables:e,iterators:t,body:n}},chunk:function(e){return{type:"Chunk",body:e}},identifier:function(e){return{type:"Identifier",name:e}},literal:function(e,t,n){return{type:e=e===f?"StringLiteral":e===d?"NumericLiteral":e===b?"BooleanLiteral":e===m?"NilLiteral":"VarargLiteral",value:t,raw:n}},tableKey:function(e,t){return{type:"TableKey",key:e,value:t}},tableKeyString:function(e,t){return{type:"TableKeyString",key:e,value:t}},tableValue:function(e){return{type:"TableValue",value:e}},tableConstructorExpression:function(e){return{type:"TableConstructorExpression",fields:e}},binaryExpression:function(e,t,n){return{type:"and"===e||"or"===e?"LogicalExpression":"BinaryExpression",operator:e,left:t,right:n}},unaryExpression:function(e,t){return{type:"UnaryExpression",operator:e,argument:t}},memberExpression:function(e,t,n){return{type:"MemberExpression",indexer:t,identifier:n,base:e}},indexExpression:function(e,t){return{type:"IndexExpression",base:e,index:t}},callExpression:function(e,t){return{type:"CallExpression",base:e,arguments:t}},tableCallExpression:function(e,t){return{type:"TableCallExpression",base:e,arguments:t}},stringCallExpression:function(e,t){return{type:"StringCallExpression",base:e,argument:t}},comment:function(e,t){return{type:"Comment",value:e,raw:t}}};function w(e){if(ue){var t=fe.pop();t.complete(),t.bless(e)}return n.onCreateNode&&n.onCreateNode(e),e}var S=Array.prototype.slice,$=(Object.prototype.toString,function(e,t){for(var n=0,r=e.length;n<r;++n)if(e[n]===t)return n;return-1});function C(e){var t=S.call(arguments,1);return e=e.replace(/%(\d)/g,(function(e,n){return""+t[n-1]||""})),e}Array.prototype.indexOf&&($=function(e,t){return e.indexOf(t)});var E,k,A,M,L,_,O,F,I,N,T,V=function(e){for(var t,n,r=S.call(arguments,1),a=0,o=r.length;a<o;++a)for(n in t=r[a])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e};function j(e){return Object.create?Object.create(e,{line:{writable:!0,value:e.line},index:{writable:!0,value:e.index},column:{writable:!0,value:e.column}}):e}function D(e){var t,n,r=C.apply(null,S.call(arguments,1));throw null===e||void 0===e.line?(n=E-F+1,(t=j(new SyntaxError(C("[%1:%2] %3",O,n,r)))).index=E,t.line=O,t.column=n):(n=e.range[0]-e.lineStart,(t=j(new SyntaxError(C("[%1:%2] %3",e.line,n,r)))).line=e.line,t.index=e.range[0],t.column=n),t}function U(e){return t.slice(e.range[0],e.range[1])||e.value}function G(e,t){D(t,y.expectedToken,e,U(t))}function B(e){var t=U(M);if(void 0!==e.type){var n;switch(e.type){case f:n="string";break;case p:n="keyword";break;case h:n="identifier";break;case d:n="number";break;case g:n="symbol";break;case b:n="boolean";break;case m:return D(e,y.unexpected,"symbol","nil",t);case u:return D(e,y.unexpectedEOF)}return D(e,y.unexpected,n,U(e),t)}return D(e,y.unexpected,"symbol",e,t)}function R(){for(P();45===t.charCodeAt(E)&&45===t.charCodeAt(E+1);)X(),P();if(E>=r)return{type:u,value:"<eof>",line:O,lineStart:F,range:[E,E]};var e,n,s,i=t.charCodeAt(E),c=t.charCodeAt(E+1);if(_=E,function(e){return e>=65&&e<=90||e>=97&&e<=122||95===e||!!(a.extendedIdentifiers&&e>=128)}(i))return function(){for(var e,n;ne(t.charCodeAt(++E)););return!function(e){switch(e.length){case 2:return"do"===e||"if"===e||"in"===e||"or"===e;case 3:return"and"===e||"end"===e||"for"===e||"not"===e;case 4:return"else"===e||"then"===e||!(!a.labels||a.contextualGoto)&&"goto"===e;case 5:return"break"===e||"local"===e||"until"===e||"while"===e;case 6:return"elseif"===e||"repeat"===e||"return"===e;case 8:return"function"===e}return!1}(e=o.fixup(t.slice(_,E)))?"true"===e||"false"===e?(n=b,e="true"===e):"nil"===e?(n=m,e=null):n=h:n=p,{type:n,value:e,line:O,lineStart:F,range:[_,E]}}();switch(i){case 39:case 34:return function(){for(var e,n=t.charCodeAt(E++),a=O,s=F,i=E,c=o.discardStrings?null:"";n!==(e=t.charCodeAt(E++));)if((E>r||Q(e))&&(c+=t.slice(i,E-1),D(null,y.unfinishedString,t.slice(_,E-1))),92===e){if(!o.discardStrings){var l=t.slice(i,E-1);c+=o.fixup(l)}var u=W();o.discardStrings||(c+=u),i=E}return o.discardStrings||(c+=o.encodeByte(null),c+=o.fixup(t.slice(i,E-1))),{type:f,value:c,line:a,lineStart:s,lastLine:O,lastLineStart:F,range:[_,E]}}();case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return H();case 46:return ee(c)?H():46===c?46===t.charCodeAt(E+2)?{type:v,value:"...",line:O,lineStart:F,range:[_,E+=3]}:Z(".."):Z(".");case 61:return Z(61===c?"==":"=");case 62:return a.bitwiseOperators&&62===c?Z(">>"):Z(61===c?">=":">");case 60:return a.bitwiseOperators&&60===c?Z("<<"):Z(61===c?"<=":"<");case 126:if(61===c)return Z("~=");if(!a.bitwiseOperators)break;return Z("~");case 58:return a.labels&&58===c?Z("::"):Z(":");case 91:return 91===c||61===c?(e=O,n=F,!1===(s=Y(!1))&&D(k,y.expected,"[",U(k)),{type:f,value:o.discardStrings?null:o.fixup(s),line:e,lineStart:n,lastLine:O,lastLineStart:F,range:[_,E]}):Z("[");case 47:return a.integerDivision&&47===c?Z("//"):Z("/");case 38:case 124:if(!a.bitwiseOperators)break;case 42:case 94:case 37:case 44:case 123:case 125:case 93:case 40:case 41:case 59:case 35:case 45:case 43:return Z(t.charAt(E))}return B(t.charAt(E))}function q(){var e=t.charCodeAt(E),n=t.charCodeAt(E+1);return!!Q(e)&&(10===e&&13===n&&++E,13===e&&10===n&&++E,++O,F=++E,!0)}function P(){for(;E<r;)if(9===(e=t.charCodeAt(E))||32===e||11===e||12===e)++E;else if(!q())break;var e}function Z(e){return E+=e.length,{type:g,value:e,line:O,lineStart:F,range:[_,E]}}function H(){var e=t.charAt(E),n=t.charAt(E+1),r="0"===e&&"xX".indexOf(n||null)>=0?function(){var e,n,r,a,o=0,s=1,i=1;for(a=E+=2,te(t.charCodeAt(E))||D(null,y.malformedNumber,t.slice(_,E));te(t.charCodeAt(E));)++E;e=parseInt(t.slice(a,E),16);var c=!1;if("."===t.charAt(E)){for(c=!0,n=++E;te(t.charCodeAt(E));)++E;o=t.slice(n,E),o=n===E?0:parseInt(o,16)/Math.pow(16,E-n)}var l=!1;if("pP".indexOf(t.charAt(E)||null)>=0){for(l=!0,++E,"+-".indexOf(t.charAt(E)||null)>=0&&(i="+"===t.charAt(E++)?1:-1),r=E,ee(t.charCodeAt(E))||D(null,y.malformedNumber,t.slice(_,E));ee(t.charCodeAt(E));)++E;s=t.slice(r,E),s=Math.pow(2,s*i)}return{value:(e+o)*s,hasFractionPart:c||l}}():function(){for(;ee(t.charCodeAt(E));)++E;var e=!1;if("."===t.charAt(E))for(e=!0,++E;ee(t.charCodeAt(E));)++E;var n=!1;if("eE".indexOf(t.charAt(E)||null)>=0)for(n=!0,++E,"+-".indexOf(t.charAt(E)||null)>=0&&++E,ee(t.charCodeAt(E))||D(null,y.malformedNumber,t.slice(_,E));ee(t.charCodeAt(E));)++E;return{value:parseFloat(t.slice(_,E)),hasFractionPart:e||n}}(),o=function(){if(a.imaginaryNumbers)return"iI".indexOf(t.charAt(E)||null)>=0&&(++E,!0)}();return function(){if(a.integerSuffixes)if("uU".indexOf(t.charAt(E)||null)>=0)if(++E,"lL".indexOf(t.charAt(E)||null)>=0){if(++E,"lL".indexOf(t.charAt(E)||null)>=0)return++E,"ULL";D(null,y.malformedNumber,t.slice(_,E))}else D(null,y.malformedNumber,t.slice(_,E));else if("lL".indexOf(t.charAt(E)||null)>=0){if(++E,"lL".indexOf(t.charAt(E)||null)>=0)return++E,"LL";D(null,y.malformedNumber,t.slice(_,E))}}()&&(o||r.hasFractionPart)&&D(null,y.malformedNumber,t.slice(_,E)),{type:d,value:r.value,line:O,lineStart:F,range:[_,E]}}function W(){var e=E;switch(t.charAt(E)){case"a":return++E,"";case"n":return++E,"\n";case"r":return++E,"\r";case"t":return++E,"\t";case"v":return++E,"\v";case"b":return++E,"\b";case"f":return++E,"\f";case"\r":case"\n":return q(),"\n";case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;ee(t.charCodeAt(E))&&E-e<3;)++E;var n=t.slice(e,E),r=parseInt(n,10);return r>255&&D(null,y.decimalEscapeTooLarge,"\\"+r),o.encodeByte(r,"\\"+n);case"z":if(a.skipWhitespaceEscape)return++E,P(),"";break;case"x":if(a.hexEscapes){if(te(t.charCodeAt(E+1))&&te(t.charCodeAt(E+2)))return E+=3,o.encodeByte(parseInt(t.slice(e+1,E),16),"\\"+t.slice(e,E));D(null,y.hexadecimalDigitExpected,"\\"+t.slice(e,E+2))}break;case"u":if(a.unicodeEscapes)return function(){var e=E++;for("{"!==t.charAt(E++)&&D(null,y.braceExpected,"{","\\"+t.slice(e,E)),te(t.charCodeAt(E))||D(null,y.hexadecimalDigitExpected,"\\"+t.slice(e,E));48===t.charCodeAt(E);)++E;for(var n=E;te(t.charCodeAt(E));)++E-n>6&&D(null,y.tooLargeCodepoint,"\\"+t.slice(e,E));var r=t.charAt(E++);"}"!==r&&('"'===r||"'"===r?D(null,y.braceExpected,"}","\\"+t.slice(e,E--)):D(null,y.hexadecimalDigitExpected,"\\"+t.slice(e,E)));var a=parseInt(t.slice(n,E-1)||"0",16),s="\\"+t.slice(e,E);return a>1114111&&D(null,y.tooLargeCodepoint,s),o.encodeUTF8(a,s)}();break;case"\\":case'"':case"'":return t.charAt(E++)}return a.strictEscapes&&D(null,y.invalidEscape,"\\"+t.slice(e,E+1)),t.charAt(E++)}function X(){_=E,E+=2;var e=t.charAt(E),a="",o=!1,s=E,i=F,c=O;if("["===e&&(!1===(a=Y(!0))?a=e:o=!0),!o){for(;E<r&&!Q(t.charCodeAt(E));)++E;n.comments&&(a=t.slice(s,E))}if(n.comments){var l=x.comment(a,t.slice(_,E));n.locations&&(l.loc={start:{line:c,column:_-i},end:{line:O,column:E-F}}),n.ranges&&(l.range=[_,E]),n.onCreateNode&&n.onCreateNode(l),L.push(l)}}function Y(e){var n,a=0,o="",s=!1,i=O;for(++E;"="===t.charAt(E+a);)++a;if("["!==t.charAt(E+a))return!1;for(E+=a+1,Q(t.charCodeAt(E))&&q(),n=E;E<r;){for(;Q(t.charCodeAt(E));)q();if("]"===t.charAt(E++)){s=!0;for(var c=0;c<a;++c)"="!==t.charAt(E+c)&&(s=!1);"]"!==t.charAt(E+a)&&(s=!1)}if(s)return o+=t.slice(n,E-1),E+=a+1,o}D(null,e?y.unfinishedLongComment:y.unfinishedLongString,i,"<eof>")}function z(){A=k,k=M,M=R()}function K(e){return e===k.value&&(z(),!0)}function J(e){e===k.value?z():D(k,y.expected,e,U(k))}function Q(e){return 10===e||13===e}function ee(e){return e>=48&&e<=57}function te(e){return e>=48&&e<=57||e>=97&&e<=102||e>=65&&e<=70}function ne(e){return e>=65&&e<=90||e>=97&&e<=122||95===e||e>=48&&e<=57||!!(a.extendedIdentifiers&&e>=128)}function re(e){if(u===e.type)return!0;if(p!==e.type)return!1;switch(e.value){case"else":case"elseif":case"end":case"until":return!0;default:return!1}}function ae(){var e=I[N++].slice();I.push(e),n.onCreateScope&&n.onCreateScope()}function oe(){I.pop(),--N,n.onDestroyScope&&n.onDestroyScope()}function se(e){n.onLocalDeclaration&&n.onLocalDeclaration(e),-1===$(I[N],e)&&I[N].push(e)}function ie(e){se(e.name),ce(e,!0)}function ce(e,t){t||-1!==function(e,t,n){for(var r=0,a=e.length;r<a;++r)if(e[r].name===n)return r;return-1}(T,0,e.name)||T.push(e),e.isLocal=t}function le(e){return-1!==$(I[N],e)}Object.assign&&(V=Object.assign),e.SyntaxError=SyntaxError,e.lex=R;var ue,fe=[];function pe(){return new he(k)}function he(e){n.locations&&(this.loc={start:{line:e.line,column:e.range[0]-e.lineStart},end:{line:0,column:0}}),n.ranges&&(this.range=[e.range[0],0])}function de(){ue&&fe.push(pe())}function ge(e){ue&&fe.push(e)}function be(){this.scopes=[],this.pendingGotos=[]}function me(){this.level=0,this.loopLevels=[]}function ve(){return a.labels?new be:new me}function ye(e){for(var t,n=[];!re(k);){if("return"===k.value||!a.relaxedBreak&&"break"===k.value){n.push(xe(e));break}t=xe(e),K(";"),t&&n.push(t)}return n}function xe(e){if(de(),g===k.type&&K("::"))return function(e){var t=k,r=Se();return n.scope&&(se("::"+t.value+"::"),ce(r,!0)),J("::"),e.addLabel(t.value,t),w(x.labelStatement(r))}(e);if(!a.emptyStatement||!K(";")){if(e.raiseDeferredErrors(),p===k.type)switch(k.value){case"local":return z(),function(e){var t,r=A;if(h===k.type){var a=[],o=[];do{t=Se(),a.push(t),e.addLocal(t.name,r)}while(K(","));if(K("="))do{var s=ke(e);o.push(s)}while(K(","));if(n.scope)for(var i=0,c=a.length;i<c;++i)ie(a[i]);return w(x.localStatement(a,o))}if(K("function"))return t=Se(),e.addLocal(t.name,r),n.scope&&(ie(t),ae()),$e(t,!0);G("<name>",k)}(e);case"if":return z(),function(e){var t,r,a,o=[];for(ue&&(a=fe[fe.length-1],fe.push(a)),t=ke(e),J("then"),n.scope&&ae(),e.pushScope(),r=ye(e),e.popScope(),n.scope&&oe(),o.push(w(x.ifClause(t,r))),ue&&(a=pe());K("elseif");)ge(a),t=ke(e),J("then"),n.scope&&ae(),e.pushScope(),r=ye(e),e.popScope(),n.scope&&oe(),o.push(w(x.elseifClause(t,r))),ue&&(a=pe());return K("else")&&(ue&&(a=new he(A),fe.push(a)),n.scope&&ae(),e.pushScope(),r=ye(e),e.popScope(),n.scope&&oe(),o.push(w(x.elseClause(r)))),J("end"),w(x.ifStatement(o))}(e);case"return":return z(),function(e){var t=[];if("end"!==k.value){var n=Ee(e);for(null!=n&&t.push(n);K(",");)n=ke(e),t.push(n);K(";")}return w(x.returnStatement(t))}(e);case"function":return z(),$e(function(){var e,t,r;for(ue&&(r=pe()),e=Se(),n.scope&&(ce(e,le(e.name)),ae());K(".");)ge(r),t=Se(),e=w(x.memberExpression(e,".",t));return K(":")&&(ge(r),t=Se(),e=w(x.memberExpression(e,":",t)),n.scope&&se("self")),e}());case"while":return z(),function(e){var t=ke(e);J("do"),n.scope&&ae(),e.pushScope(!0);var r=ye(e);return e.popScope(),n.scope&&oe(),J("end"),w(x.whileStatement(t,r))}(e);case"for":return z(),function(e){var t,r=Se();if(n.scope&&(ae(),ie(r)),K("=")){var a=ke(e);J(",");var o=ke(e),s=K(",")?ke(e):null;return J("do"),e.pushScope(!0),t=ye(e),e.popScope(),J("end"),n.scope&&oe(),w(x.forNumericStatement(r,a,o,s,t))}for(var i=[r];K(",");)r=Se(),n.scope&&ie(r),i.push(r);J("in");var c=[];do{var l=ke(e);c.push(l)}while(K(","));return J("do"),e.pushScope(!0),t=ye(e),e.popScope(),J("end"),n.scope&&oe(),w(x.forGenericStatement(i,c,t))}(e);case"repeat":return z(),function(e){n.scope&&ae(),e.pushScope(!0);var t=ye(e);J("until"),e.raiseDeferredErrors();var r=ke(e);return e.popScope(),n.scope&&oe(),w(x.repeatStatement(r,t))}(e);case"break":return z(),e.isInLoop()||D(k,y.noLoopToBreak,k.value),w(x.breakStatement());case"do":return z(),function(e){n.scope&&ae(),e.pushScope();var t=ye(e);return e.popScope(),n.scope&&oe(),J("end"),w(x.doStatement(t))}(e);case"goto":return z(),we(e)}return a.contextualGoto&&k.type===h&&"goto"===k.value&&M.type===h&&"goto"!==M.value?(z(),we(e)):(ue&&fe.pop(),function(e){var t,r,a,o,s,i=[];for(ue&&(r=pe());;){if(ue&&(t=pe()),h===k.type)s=k.value,o=Se(),n.scope&&ce(o,le(s)),a=!0;else{if("("!==k.value)return B(k);z(),o=ke(e),J(")"),a=!1}e:for(;;){switch(f===k.type?'"':k.value){case".":case"[":a=!0;break;case":":case"(":case"{":case'"':a=null;break;default:break e}o=Le(o,t,e)}if(i.push(o),","!==k.value)break;if(!a)return B(k);z()}if(1===i.length&&null===a)return ge(t),w(x.callStatement(i[0]));if(!a)return B(k);J("=");var c=[];do{c.push(ke(e))}while(K(","));return ge(r),w(x.assignmentStatement(i,c))}(e))}ue&&fe.pop()}function we(e){var t=k.value,n=A,r=Se();return e.addGoto(t,n),w(x.gotoStatement(r))}function Se(){de();var e=k.value;return h!==k.type&&G("<name>",k),z(),w(x.identifier(e))}function $e(e,t){var r=ve();r.pushScope();var a=[];if(J("("),!K(")"))for(;;){if(h===k.type){var o=Se();if(n.scope&&ie(o),a.push(o),K(","))continue}else v===k.type?(r.allowVararg=!0,a.push(Oe(r))):G("<name> or '...'",k);J(")");break}var s=ye(r);return r.popScope(),J("end"),n.scope&&oe(),t=t||!1,w(x.functionStatement(e,a,t,s))}function Ce(e){for(var t,n,r=[];;){if(de(),g===k.type&&K("["))t=ke(e),J("]"),J("="),n=ke(e),r.push(w(x.tableKey(t,n)));else if(h===k.type)"="===M.value?(t=Se(),z(),n=ke(e),r.push(w(x.tableKeyString(t,n)))):(n=ke(e),r.push(w(x.tableValue(n))));else{if(null==(n=Ee(e))){fe.pop();break}r.push(w(x.tableValue(n)))}if(!(",;".indexOf(k.value)>=0))break;z()}return J("}"),w(x.tableConstructorExpression(r))}function Ee(e){return Me(0,e)}function ke(e){var t=Ee(e);if(null!=t)return t;G("<expression>",k)}function Ae(e){var t=e.charCodeAt(0),n=e.length;if(1===n)switch(t){case 94:return 12;case 42:case 47:case 37:return 10;case 43:case 45:return 9;case 38:return 6;case 126:return 5;case 124:return 4;case 60:case 62:return 3}else if(2===n)switch(t){case 47:return 10;case 46:return 8;case 60:case 62:return"<<"===e||">>"===e?7:3;case 61:case 126:return 3;case 111:return 1}else if(97===t&&"and"===e)return 2;return 0}function Me(e,t){var r,a,o,s=k.value;if(ue&&(a=pe()),function(e){return g===e.type?"#-~".indexOf(e.value)>=0:p===e.type&&"not"===e.value}(k)){de(),z();var i=Me(10,t);null==i&&G("<expression>",k),r=w(x.unaryExpression(s,i))}if(null==r&&null==(r=Oe(t))&&(r=function(e){var t,r,a;if(ue&&(a=pe()),h===k.type)r=k.value,t=Se(),n.scope&&ce(t,le(r));else{if(!K("("))return null;t=ke(e),J(")")}for(;;){var o=Le(t,a,e);if(null===o)break;t=o}return t}(t)),null==r)return null;for(;s=k.value,!(0===(o=g===k.type||p===k.type?Ae(s):0)||o<=e);){"^"!==s&&".."!==s||--o,z();var c=Me(o,t);null==c&&G("<expression>",k),ue&&fe.push(a),r=w(x.binaryExpression(s,r,c))}return r}function Le(e,t,n){var r,a;if(g===k.type)switch(k.value){case"[":return ge(t),z(),r=ke(n),J("]"),w(x.indexExpression(e,r));case".":return ge(t),z(),a=Se(),w(x.memberExpression(e,".",a));case":":return ge(t),z(),a=Se(),e=w(x.memberExpression(e,":",a)),ge(t),_e(e,n);case"(":case"{":return ge(t),_e(e,n)}else if(f===k.type)return ge(t),_e(e,n);return null}function _e(e,t){if(g===k.type)switch(k.value){case"(":a.emptyStatement||k.line!==A.line&&D(null,y.ambiguousSyntax,k.value),z();var n=[],r=Ee(t);for(null!=r&&n.push(r);K(",");)r=ke(t),n.push(r);return J(")"),w(x.callExpression(e,n));case"{":de(),z();var o=Ce(t);return w(x.tableCallExpression(e,o))}else if(f===k.type)return w(x.stringCallExpression(e,Oe(t)));G("function arguments",k)}function Oe(e){var r,a=f|d|b|m|v,o=k.value,s=k.type;if(ue&&(r=pe()),s!==v||e.allowVararg||D(k,y.cannotUseVararg,k.value),s&a){ge(r);var i=t.slice(k.range[0],k.range[1]);return z(),w(x.literal(s,o,i))}return p===s&&"function"===o?(ge(r),z(),n.scope&&ae(),$e(null)):K("{")?(ge(r),Ce(e)):void 0}he.prototype.complete=function(){n.locations&&(this.loc.end.line=A.lastLine||A.line,this.loc.end.column=A.range[1]-(A.lastLineStart||A.lineStart)),n.ranges&&(this.range[1]=A.range[1])},he.prototype.bless=function(e){if(this.loc){var t=this.loc;e.loc={start:{line:t.start.line,column:t.start.column},end:{line:t.end.line,column:t.end.column}}}this.range&&(e.range=[this.range[0],this.range[1]])},be.prototype.isInLoop=function(){for(var e=this.scopes.length;e-- >0;)if(this.scopes[e].isLoop)return!0;return!1},be.prototype.pushScope=function(e){var t={labels:{},locals:[],deferredGotos:[],isLoop:!!e};this.scopes.push(t)},be.prototype.popScope=function(){for(var e=0;e<this.pendingGotos.length;++e){var t=this.pendingGotos[e];t.maxDepth>=this.scopes.length&&--t.maxDepth<=0&&D(t.token,y.labelNotVisible,t.target)}this.scopes.pop()},be.prototype.addGoto=function(e,t){for(var n=[],r=0;r<this.scopes.length;++r){var a=this.scopes[r];if(n.push(a.locals.length),Object.prototype.hasOwnProperty.call(a.labels,e))return}this.pendingGotos.push({maxDepth:this.scopes.length,target:e,token:t,localCounts:n})},be.prototype.addLabel=function(e,t){var n=this.currentScope();if(Object.prototype.hasOwnProperty.call(n.labels,e))D(t,y.labelAlreadyDefined,e,n.labels[e].line);else{for(var r=[],a=0;a<this.pendingGotos.length;++a){var o=this.pendingGotos[a];o.maxDepth>=this.scopes.length&&o.target===e?o.localCounts[this.scopes.length-1]<n.locals.length&&n.deferredGotos.push(o):r.push(o)}this.pendingGotos=r}n.labels[e]={localCount:n.locals.length,line:t.line}},be.prototype.addLocal=function(e,t){this.currentScope().locals.push({name:e,token:t})},be.prototype.currentScope=function(){return this.scopes[this.scopes.length-1]},be.prototype.raiseDeferredErrors=function(){for(var e=this.currentScope(),t=e.deferredGotos,n=0;n<t.length;++n){var r=t[n];D(r.token,y.gotoJumpInLocalScope,r.target,e.locals[r.localCounts[this.scopes.length-1]].name)}},me.prototype.isInLoop=function(){return!!this.loopLevels.length},me.prototype.pushScope=function(e){++this.level,e&&this.loopLevels.push(this.level)},me.prototype.popScope=function(){var e=this.loopLevels,t=e.length;t&&e[t-1]===this.level&&e.pop(),--this.level},me.prototype.addGoto=me.prototype.addLabel=function(){throw new Error("This should never happen")},me.prototype.addLocal=me.prototype.raiseDeferredErrors=function(){},e.parse=function(i,c){if(void 0===c&&"object"==typeof i&&(c=i,i=void 0),c||(c={}),t=i||"",n=V({},s,c),E=0,O=1,F=0,r=t.length,I=[[]],N=0,T=[],fe=[],!Object.prototype.hasOwnProperty.call(Fe,n.luaVersion))throw new Error(C("Lua version '%1' not supported",n.luaVersion));if(a=V({},Fe[n.luaVersion]),void 0!==n.extendedIdentifiers&&(a.extendedIdentifiers=!!n.extendedIdentifiers),!Object.prototype.hasOwnProperty.call(l,n.encodingMode))throw new Error(C("Encoding mode '%1' not supported",n.encodingMode));return o=l[n.encodingMode],n.comments&&(L=[]),n.wait?e:Ne()};var Fe={5.1:{},5.2:{labels:!0,emptyStatement:!0,hexEscapes:!0,skipWhitespaceEscape:!0,strictEscapes:!0,relaxedBreak:!0},5.3:{labels:!0,emptyStatement:!0,hexEscapes:!0,skipWhitespaceEscape:!0,strictEscapes:!0,unicodeEscapes:!0,bitwiseOperators:!0,integerDivision:!0,relaxedBreak:!0},LuaJIT:{labels:!0,contextualGoto:!0,hexEscapes:!0,skipWhitespaceEscape:!0,strictEscapes:!0,unicodeEscapes:!0,imaginaryNumbers:!0,integerSuffixes:!0}};function Ie(n){return t+=String(n),r=t.length,e}function Ne(e){void 0!==e&&Ie(e),t&&"#!"===t.substr(0,2)&&(t=t.replace(/^.*/,(function(e){return e.replace(/./g," ")}))),r=t.length,ue=n.locations||n.ranges,M=R();var a=function(){z(),de(),n.scope&&ae();var e=ve();e.allowVararg=!0,e.pushScope();var t=ye(e);return e.popScope(),n.scope&&oe(),u!==k.type&&B(k),ue&&!t.length&&(A=k),w(x.chunk(t))}();if(n.comments&&(a.comments=L),n.scope&&(a.globals=T),fe.length>0)throw new Error("Location tracking failed. This is most likely a bug in luaparse");return a}e.write=Ie,e.end=Ne}))}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{"use strict";var e=n(183),t=n.n(e),r={};var a=JSON.stringify;function o(){for(var e=new Array(arguments.length-1),t=0;t<e.length;++t)e[t]=arguments[t+1];return function(e,t){for(var n="",r=0,o=0,s=0,i="",c=0;c<e.length;++c){var l=e[c],u=l[0].charCodeAt(0);if(76!==u)if(37!==u){var f="",p=0,h=10,d=4,g=!1,b=l[3],m=b.indexOf("#")>-1;if(l[2])r=parseInt(l[2],10)-1;else if(109===u&&!m){n+="Success";continue}var v=0;l[4].length>0&&(v="*"!==l[4].charAt(0)?parseInt(l[4],10):1===l[4].length?t[o++]:t[parseInt(l[4].substr(1),10)-1]);var y=-1;l[5].length>0&&(y="*"!==l[5].charAt(0)?parseInt(l[5],10):1===l[5].length?t[o++]:t[parseInt(l[5].substr(1),10)-1]),l[2]||(r=o++);var x=t[r],w=l[6];switch(u){case 83:case 115:f=String(x),y>=0&&(f=f.substr(0,y)),(v>f.length||-v>f.length)&&((-1==b.indexOf("-")||v<0)&&-1!=b.indexOf("0")?f=(i=v-f.length>=0?"0".repeat(v-f.length):"")+f:(i=v-f.length>=0?" ".repeat(v-f.length):"",f=b.indexOf("-")>-1?f+i:i+f));break;case 67:case 99:switch(typeof x){case"number":var S=x;67==u||108===w.charCodeAt(0)?(S&=4294967295,f=String.fromCharCode(S)):(S&=255,f=String.fromCharCode(S));break;case"string":f=x.charAt(0);break;default:f=String(x).charAt(0)}(v>f.length||-v>f.length)&&((-1==b.indexOf("-")||v<0)&&-1!=b.indexOf("0")?f=(i=v-f.length>=0?"0".repeat(v-f.length):"")+f:(i=v-f.length>=0?" ".repeat(v-f.length):"",f=b.indexOf("-")>-1?f+i:i+f));break;case 68:d=8;case 100:case 105:p=-1,g=!0;break;case 85:d=8;case 117:p=-1;break;case 79:d=8;case 111:p=-1,h=8;break;case 120:p=-1,h=-16;break;case 88:p=-1,h=16;break;case 66:d=8;case 98:p=-1,h=2;break;case 70:case 102:p=1;break;case 69:case 101:p=2;break;case 71:case 103:p=3;break;case 65:case 97:p=4;break;case 112:s="number"==typeof x?x:x?Number(x.l):-1,isNaN(s)&&(s=-1),f=m?s.toString(10):"0x"+(s=Math.abs(s)).toString(16).toLowerCase();break;case 110:x&&(x.len=n.length);continue;case 109:f=x instanceof Error?x.message?x.message:x.errno?"Error number "+x.errno:"Error "+String(x):"Success";break;case 74:f=(m?a:JSON.stringify)(x);break;case 86:f=null==x?"null":String(x.valueOf());break;case 84:f=m?(f=Object.prototype.toString.call(x).substr(8)).substr(0,f.length-1):typeof x;break;case 89:case 121:f=x?m?"yes":"true":m?"no":"false",89==u&&(f=f.toUpperCase()),y>=0&&(f=f.substr(0,y)),(v>f.length||-v>f.length)&&((-1==b.indexOf("-")||v<0)&&-1!=b.indexOf("0")?f=(i=v-f.length>=0?"0".repeat(v-f.length):"")+f:(i=v-f.length>=0?" ".repeat(v-f.length):"",f=b.indexOf("-")>-1?f+i:i+f))}if(v<0&&(v=-v,b+="-"),-1==p){switch(s=Number(x),w){case"hh":d=1;break;case"h":d=2;break;case"l":case"L":case"q":case"ll":case"j":case"t":case"z":case"Z":case"I":4==d&&(d=8)}switch(d){case 1:s&=255,g&&s>127&&(s-=256);break;case 2:s&=65535,g&&s>32767&&(s-=65536);break;case 4:s=g?0|s:s>>>0;break;default:s=isNaN(s)?0:Math.round(s)}if(d>4&&s<0&&!g)if(16==h||-16==h)f=(s>>>0).toString(16),f=(16-(f=((s=Math.floor((s-(s>>>0))/Math.pow(2,32)))>>>0).toString(16)+(8-f.length>=0?"0".repeat(8-f.length):"")+f).length>=0?"f".repeat(16-f.length):"")+f,16==h&&(f=f.toUpperCase());else if(8==h)f=(10-(f=(s>>>0).toString(8)).length>=0?"0".repeat(10-f.length):"")+f,f="1"+(21-(f=(f=((s=Math.floor((s-(s>>>0&1073741823))/Math.pow(2,30)))>>>0).toString(8)+f.substr(f.length-10)).substr(f.length-20)).length>=0?"7".repeat(21-f.length):"")+f;else{s=-s%1e16;for(var $=[1,8,4,4,6,7,4,4,0,7,3,7,0,9,5,5,1,6,1,6],C=$.length-1;s>0;)($[C]-=s%10)<0&&($[C]+=10,$[C-1]--),--C,s=Math.floor(s/10);f=$.join("")}else f=-16===h?s.toString(16).toLowerCase():16===h?s.toString(16).toUpperCase():s.toString(h);if(0!==y||"0"!=f||8==h&&m){if(f.length<y+("-"==f.substr(0,1)?1:0)&&(f="-"!=f.substr(0,1)?(y-f.length>=0?"0".repeat(y-f.length):"")+f:f.substr(0,1)+(y+1-f.length>=0?"0".repeat(y+1-f.length):"")+f.substr(1)),!g&&m&&0!==s)switch(h){case-16:f="0x"+f;break;case 16:f="0X"+f;break;case 8:"0"!=f.charAt(0)&&(f="0"+f);break;case 2:f="0b"+f}}else f="";g&&"-"!=f.charAt(0)&&(b.indexOf("+")>-1?f="+"+f:b.indexOf(" ")>-1&&(f=" "+f)),v>0&&f.length<v&&(b.indexOf("-")>-1?f+=v-f.length>=0?" ".repeat(v-f.length):"":b.indexOf("0")>-1&&y<0&&f.length>0?(y>f.length&&(f=(y-f.length>=0?"0".repeat(y-f.length):"")+f),i=v-f.length>=0?(y>0?" ":"0").repeat(v-f.length):"",f=f.charCodeAt(0)<48?"x"==f.charAt(2).toLowerCase()?f.substr(0,3)+i+f.substring(3):f.substr(0,1)+i+f.substring(1):"x"==f.charAt(1).toLowerCase()?f.substr(0,2)+i+f.substring(2):i+f):f=(v-f.length>=0?" ".repeat(v-f.length):"")+f)}else if(p>0){s=Number(x),null===x&&(s=NaN),"L"==w&&(d=12);var E=isFinite(s);if(E){var k=0;-1==y&&4!=p&&(y=6),3==p&&(0===y&&(y=1),y>(k=+(f=s.toExponential(1)).substr(f.indexOf("e")+1))&&k>=-4?(p=11,y-=k+1):(p=12,y-=1));var A=s<0||1/s==-1/0?"-":"";switch(s<0&&(s=-s),p){case 1:case 11:if(s<1e21){f=s.toFixed(y),1==p?0===y&&m&&-1==f.indexOf(".")&&(f+="."):m?-1==f.indexOf(".")&&(f+="."):f=f.replace(/(\.\d*[1-9])0*$/,"$1").replace(/\.0*$/,"");break}k=+(f=s.toExponential(20)).substr(f.indexOf("e")+1),f=f.charAt(0)+f.substr(2,f.indexOf("e")-2),f+=k-f.length+1>=0?"0".repeat(k-f.length+1):"",(m||y>0&&11!==p)&&(f=f+"."+(y>=0?"0".repeat(y):""));break;case 2:case 12:k=(f=s.toExponential(y)).indexOf("e"),f.length-k==3&&(f=f.substr(0,k+2)+"0"+f.substr(k+2)),m&&-1==f.indexOf(".")?f=f.substr(0,k)+"."+f.substr(k):m||12!=p||(f=f.replace(/\.0*e/,"e").replace(/\.(\d*[1-9])0*e/,".$1e"));break;case 4:if(0===s){f="0x0"+(m||y>0?"."+(y>=0?"0".repeat(y):""):"")+"p+0";break}var M=(f=s.toString(16)).charCodeAt(0);if(48==M){for(M=2,k=-4,s*=16;48==f.charCodeAt(M++);)k-=4,s*=16;M=(f=s.toString(16)).charCodeAt(0)}var L=f.indexOf(".");if(f.indexOf("(")>-1){var _=f.match(/\(e(.*)\)/),O=_?+_[1]:0;k+=4*O,s/=Math.pow(16,O)}else L>1?(k+=4*(L-1),s/=Math.pow(16,L-1)):-1==L&&(k+=4*(f.length-1),s/=Math.pow(16,f.length-1));if(d>8?M<50?(k-=3,s*=8):M<52?(k-=2,s*=4):M<56&&(k-=1,s*=2):M>=56?(k+=3,s/=8):M>=52?(k+=2,s/=4):M>=50&&(k+=1,s/=2),(f=s.toString(16)).length>1){if(f.length>y+2&&f.charCodeAt(y+2)>=56){var F=102==f.charCodeAt(0);f=(s+8*Math.pow(16,-y-1)).toString(16),F&&49==f.charCodeAt(0)&&(k+=4)}y>0?(f=f.substr(0,y+2)).length<y+2&&(f.charCodeAt(0)<48?f=f.charAt(0)+(y+2-f.length>=0?"0".repeat(y+2-f.length):"")+f.substr(1):f+=y+2-f.length>=0?"0".repeat(y+2-f.length):""):0===y&&(f=f.charAt(0)+(m?".":""))}else y>0?f=f+"."+(y>=0?"0".repeat(y):""):m&&(f+=".");f="0x"+f+"p"+(k>=0?"+"+k:k)}""===A&&(b.indexOf("+")>-1?A="+":b.indexOf(" ")>-1&&(A=" ")),f=A+f}else s<0?f="-":b.indexOf("+")>-1?f="+":b.indexOf(" ")>-1&&(f=" "),f+=isNaN(s)?"nan":"inf";v>f.length&&(b.indexOf("-")>-1?f+=v-f.length>=0?" ".repeat(v-f.length):"":b.indexOf("0")>-1&&f.length>0&&E?(i=v-f.length>=0?"0".repeat(v-f.length):"",f=f.charCodeAt(0)<48?"x"==f.charAt(2).toLowerCase()?f.substr(0,3)+i+f.substring(3):f.substr(0,1)+i+f.substring(1):"x"==f.charAt(1).toLowerCase()?f.substr(0,2)+i+f.substring(2):i+f):f=(v-f.length>=0?" ".repeat(v-f.length):"")+f),u<96&&(f=f.toUpperCase())}n+=f}else n+="%";else n+=l[1]}return n}(function(e){if(r[e])return r[e];for(var t=[],n=0,a=0,o=!1,s="",i="",c="",l="",u="",f=0,p=e.length;a<p;++a)if(f=e.charCodeAt(a),o)if(f>=48&&f<58)l.length?l+=String.fromCharCode(f):48!=f||c.length?c+=String.fromCharCode(f):i+=String.fromCharCode(f);else switch(f){case 36:l.length?l+="$":"*"==c.charAt(0)?c+="$":(s=c+"$",c="");break;case 39:i+="'";break;case 45:i+="-";break;case 43:i+="+";break;case 32:i+=" ";break;case 35:i+="#";break;case 46:l=".";break;case 42:"."==l.charAt(0)?l+="*":c+="*";break;case 104:case 108:if(u.length>1)throw"bad length "+u+String(f);u+=String.fromCharCode(f);break;case 76:case 106:case 122:case 116:case 113:case 90:case 119:if(""!==u)throw"bad length "+u+String.fromCharCode(f);u=String.fromCharCode(f);break;case 73:if(""!==u)throw"bad length "+u+"I";u="I";break;case 100:case 105:case 111:case 117:case 120:case 88:case 102:case 70:case 101:case 69:case 103:case 71:case 97:case 65:case 99:case 67:case 115:case 83:case 112:case 110:case 68:case 85:case 79:case 109:case 98:case 66:case 121:case 89:case 74:case 86:case 84:case 37:o=!1,l.length>1&&(l=l.substr(1)),t.push([String.fromCharCode(f),e.substring(n,a+1),s,i,c,l,u]),n=a+1,u=l=c=i=s="";break;default:throw new Error("Invalid format string starting with |"+e.substring(n,a+1)+"|")}else{if(37!==f)continue;n<a&&t.push(["L",e.substring(n,a)]),n=a,o=!0}return n<e.length&&t.push(["L",e.substring(n)]),r[e]=t}(arguments[0]),e)}class s extends Error{constructor(e){super(),this.message=e}toString(){return`LuaError: ${this.message}`}}class i{constructor(e){if(this.numValues=[void 0],this.strValues={},this.keys=[],this.values=[],this.metatable=null,void 0!==e)if("function"!=typeof e){if(Array.isArray(e))this.insert(...e);else for(const t in e)if(S(e,t)){let n=e[t];null===n&&(n=void 0),this.set(t,n)}}else e(this)}get(e){const t=this.rawget(e);if(void 0===t&&this.metatable){const t=this.metatable.get("__index");if(t instanceof i)return t.get(e);if("function"==typeof t){const n=t.call(void 0,this,e);return n instanceof Array?n[0]:n}}return t}rawget(e){switch(typeof e){case"string":if(S(this.strValues,e))return this.strValues[e];break;case"number":if(e>0&&e%1==0)return this.numValues[e]}const t=this.keys.indexOf(f(e));return-1===t?void 0:this.values[t]}getMetaMethod(e){return this.metatable&&this.metatable.rawget(e)}set(e,t){const n=this.metatable&&this.metatable.get("__newindex");if(n&&void 0===this.rawget(e)){if(n instanceof i)return n.set(e,t);if("function"==typeof n)return n(this,e,t)}this.rawset(e,t)}setFn(e){return t=>this.set(e,t)}rawset(e,t){switch(typeof e){case"string":return void(this.strValues[e]=t);case"number":if(e>0&&e%1==0)return void(this.numValues[e]=t)}const n=f(e),r=this.keys.indexOf(n);r>-1?this.values[r]=t:(this.values[this.keys.length]=t,this.keys.push(n))}insert(...e){this.numValues.push(...e)}toObject(){const e=0===Object.keys(this.strValues).length&&this.getn()>0,t=e?[]:{};for(let n=1;n<this.numValues.length;n++){const r=this.numValues[n],a=r instanceof i?r.toObject():r;e?t[n-1]=a:t[String(n-1)]=a}for(const e in this.strValues)if(S(this.strValues,e)){const n=this.strValues[e],r=n instanceof i?n.toObject():n;t[e]=r}return t}getn(){const e=this.numValues,t=[];for(const n in e)S(e,n)&&(t[n]=!0);let n=0;for(;t[n+1];)n+=1;if(n>0&&void 0===e[n]){let t=0;for(;n-t>1;){const r=Math.floor((t+n)/2);void 0===e[r]?n=r:t=r}return t}return n}}const c=/^[-+]?[0-9]*\.?([0-9]+([eE][-+]?[0-9]+)?)?$/,l=/^(-)?0x([0-9a-fA-F]*)\.?([0-9a-fA-F]*)$/;function u(e){const t=typeof e;switch(t){case"undefined":return"nil";case"number":case"string":case"boolean":case"function":return t;case"object":if(e instanceof i)return"table";if(e instanceof Function)return"function"}}function f(e){if(e instanceof i){const n=e.getMetaMethod("__tostring");return n?n(e)[0]:t(e,"table: 0x")}return e instanceof Function?t(e,"function: 0x"):b(e);function t(e,t){const n=e.toString();if(n.indexOf(t)>-1)return n;const r=t+Math.floor(4294967295*Math.random()).toString(16);return e.toString=()=>r,r}}function p(e,t){return e>=0?e:-e>t?0:t+e+1}function h(e,t){if(t)throw new s(`${t}`.replace(/%type/gi,u(e)))}function d(e){return!(!1===e||void 0===e)}function g(e,t){if("number"==typeof e)return e;switch(e){case void 0:return;case"inf":return 1/0;case"-inf":return-1/0;case"nan":return NaN}const n=`${e}`;if(n.match(c))return parseFloat(n);const r=n.match(l);if(r){const[,e,t,n]=r;let a=parseInt(t,16)||0;return n&&(a+=parseInt(n,16)/Math.pow(16,n.length)),e&&(a*=-1),a}void 0!==t&&h(e,t)}function b(e,t){if("string"==typeof e)return e;switch(e){case void 0:case null:return"nil";case 1/0:return"inf";case-1/0:return"-inf"}return"number"==typeof e?Number.isNaN(e)?"nan":`${e}`:"boolean"==typeof e?`${e}`:void 0===t?"nil":void h(e,t)}function m(e,t,n,r,a){return t(e,`bad argument #${a} to '${r}' (${n} expected, got %type)`)}function v(e,t,n){return m(e,g,"number",t,n)}function y(e,t,n){return m(e,b,"string",t,n)}function x(e,t,n){if(e instanceof i)return e;{const r=u(e);throw new s(`bad argument #${n} to '${t}' (table expected, got ${r})`)}}const w=e=>e instanceof Array?e:[e],S=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);class ${constructor(e={}){this._variables=e}get(e){return this._variables[e]}set(e,t){S(this._variables,e)||!this.parent?this.setLocal(e,t):this.parent.set(e,t)}setLocal(e,t){this._variables[e]=t}setVarargs(e){this._varargs=e}getVarargs(){return this._varargs||this.parent&&this.parent.getVarargs()||[]}extend(){const e=Object.create(this._variables),t=new $(e);return t.parent=this,t}}const C=e=>"IfClause"===e.type||"ElseifClause"===e.type||"ElseClause"===e.type||"WhileStatement"===e.type||"DoStatement"===e.type||"RepeatStatement"===e.type||"FunctionDeclaration"===e.type||"ForNumericStatement"===e.type||"ForGenericStatement"===e.type||"Chunk"===e.type;class E extends String{constructor(e,t){super(),this.base=e,this.property=t}get(){return`__lua.get(${this.base}, ${this.property})`}set(e){return`${this.base}.set(${this.property}, ${e})`}setFn(){return`${this.base}.setFn(${this.property})`}toString(){return this.get()}valueOf(){return this.get()}}const k={not:"not","-":"unm","~":"bnot","#":"len"},A={"+":"add","-":"sub","*":"mul","%":"mod","^":"pow","/":"div","//":"idiv","&":"band","|":"bor","~":"bxor","<<":"shl",">>":"shr","..":"concat","~=":"neq","==":"eq","<":"lt","<=":"le",">":"gt",">=":"ge"},M=e=>{switch(e.type){case"LabelStatement":return`case '${e.label.name}': label = undefined`;case"BreakStatement":return"break";case"GotoStatement":return`label = '${e.label.name}'; continue`;case"ReturnStatement":return`return ${O(e.arguments)}`;case"IfStatement":return e.clauses.map((e=>M(e))).join(" else ");case"IfClause":case"ElseifClause":return`if (__lua.bool(${_(e.condition)})) {\n${L(e)}\n}`;case"ElseClause":return`{\n${L(e)}\n}`;case"WhileStatement":return`while(${_(e.condition)}) {\n${L(e)}\n}`;case"DoStatement":return`\n${L(e)}\n`;case"RepeatStatement":{const t=_(e.condition);return`do {\n${L(e)}\n} while (!(${t}))`}case"LocalStatement":case"AssignmentStatement":return I(e);case"CallStatement":return M(e.expression);case"FunctionDeclaration":{const t=t=>{const n=t.join(";\n"),r=L(e,n);return`(${0===t.length?"":"...args"}) => {\n${r}${-1===e.body.findIndex((e=>"ReturnStatement"===e.type))?"\nreturn []":""}\n}`},n=e.parameters.map((e=>"VarargLiteral"===e.type?`$${D.get(e)}.setVarargs(args)`:`$${D.get(e)}.setLocal('${e.name}', args.shift())`));if(null===e.identifier)return t(n);if("Identifier"===e.identifier.type)return`$${D.get(e.identifier)}.${e.isLocal?"setLocal":"set"}('${e.identifier.name}', ${t(n)})`;const r=M(e.identifier);return":"===e.identifier.indexer&&n.unshift(`$${D.get(e)}.setLocal('self', args.shift())`),r.set(t(n))}case"ForNumericStatement":{const t=e.variable.name,n=`let ${t} = ${_(e.start)}, end = ${_(e.end)}, step = ${null===e.step?1:_(e.step)}`,r=`step > 0 ? ${t} <= end : ${t} >= end`,a=`${t} += step`,o=`$${D.get(e.variable)}.setLocal('${t}', ${t});`;return`for (${n}; ${r}; ${a}) {\n${L(e,o)}\n}`}case"ForGenericStatement":{const t=O(e.iterators),n=e.variables.map(((e,t)=>`$${D.get(e)}.setLocal('${e.name}', res[${t}])`)).join(";\n");return`for (let [iterator, table, next] = ${t}, res = __lua.call(iterator, table, next); res[0] !== undefined; res = __lua.call(iterator, table, res[0])) {\n${L(e,n)}\n}`}case"Chunk":return`'use strict'\nconst $0 = __lua.globalScope\nlet vars\nlet vals\nlet label\n\n${L(e)}`;case"Identifier":return`$${D.get(e)}.get('${e.name}')`;case"StringLiteral":return`\`${e.value.replace(/([^\\])?\\(\d{1,3})/g,((e,t,n)=>`${t||""}${String.fromCharCode(n)}`)).replace(/\\/g,"\\\\").replace(/`/g,"\\`")}\``;case"NumericLiteral":return e.value.toString();case"BooleanLiteral":return e.value?"true":"false";case"NilLiteral":return"undefined";case"VarargLiteral":return`$${D.get(e)}.getVarargs()`;case"TableConstructorExpression":return 0===e.fields.length?"new __lua.Table()":`new __lua.Table(t => {\n${e.fields.map(((e,t,n)=>"TableKey"===e.type?`t.rawset(${M(e.key)}, ${_(e.value)})`:"TableKeyString"===e.type?`t.rawset('${e.key.name}', ${_(e.value)})`:"TableValue"===e.type?t===n.length-1&&T(e.value)?`t.insert(...${M(e.value)})`:`t.insert(${_(e.value)})`:void 0)).join(";\n")}\n})`;case"UnaryExpression":{const t=k[e.operator],n=_(e.argument);if(!t)throw new Error(`Unhandled unary operator: ${e.operator}`);return`__lua.${t}(${n})`}case"BinaryExpression":{const t=_(e.left),n=_(e.right),r=A[e.operator];if(!r)throw new Error(`Unhandled binary operator: ${e.operator}`);return`__lua.${r}(${t}, ${n})`}case"LogicalExpression":{const t=_(e.left),n=_(e.right),r=e.operator;if("and"===r)return`__lua.and(${t},${n})`;if("or"===r)return`__lua.or(${t},${n})`;throw new Error(`Unhandled logical operator: ${e.operator}`)}case"MemberExpression":{const t=_(e.base);return new E(t,`'${e.identifier.name}'`)}case"IndexExpression":{const t=_(e.base),n=_(e.index);return new E(t,n)}case"CallExpression":case"TableCallExpression":case"StringCallExpression":{const t=_(e.base),n="CallExpression"===e.type?F(e.arguments).join(", "):_("TableCallExpression"===e.type?e.arguments:e.argument);return t instanceof E&&"MemberExpression"===e.base.type&&":"===e.base.indexer?`__lua.call(${t}, ${t.base}, ${n})`:`__lua.call(${t}, ${n})`}default:throw new Error(`No generator found for: ${e.type}`)}},L=(e,t="")=>{const n=D.get(e),r=void 0===n?"":`const $${n} = $${j.get(n)}.extend();`,a=e.body.map((e=>M(e))).join(";\n"),o=G.get(e);if(void 0===o)return`${r}\n${t}\n${a}`;const s=`L${o}: do { switch(label) { case undefined:`,i=U.get(o);return`${r}\n${s}\n${t}\n${a}\n${(void 0===i?"":`break; default: continue L${i}\n`)+"} } while (label)"}`},_=e=>{const t=M(e);return T(e)?`${t}[0]`:t},O=e=>1===e.length&&T(e[0])?M(e[0]):`[${F(e).join(", ")}]`,F=e=>e.map(((e,t,n)=>{const r=M(e);return T(e)?t===n.length-1?`...${r}`:`${r}[0]`:r})),I=e=>{const t=[],n=[],r=e.variables.length>1&&e.init.length>0&&!e.init.every(V);for(let a=0;a<e.variables.length;a++){const o=e.variables[a],s=e.init[a],i=r?`vars[${a}]`:void 0===s?"undefined":_(s);if("Identifier"===o.type){const n="LocalStatement"===e.type?"setLocal":"set";t.push(`$${D.get(o)}.${n}('${o.name}', ${i})`)}else{const e=M(o);r?(t.push(`vals[${n.length}](${i})`),n.push(e.setFn())):t.push(e.set(i))}}for(let n=e.variables.length;n<e.init.length;n++){const r=e.init[n];N(r)&&t.push(M(r))}return r&&(t.unshift(`vars = ${O(e.init)}`),n.length>0&&t.unshift(`vals = [${n.join(", ")}]`)),t.join(";\n")},N=e=>"CallExpression"===e.type||"StringCallExpression"===e.type||"TableCallExpression"===e.type,T=e=>N(e)||"VarargLiteral"===e.type,V=e=>"StringLiteral"===e.type||"NumericLiteral"===e.type||"BooleanLiteral"===e.type||"NilLiteral"===e.type||"TableConstructorExpression"===e.type,j=new Map,D=new Map,U=new Map,G=new Map,B=e=>{const n=t().parse(e.replace(/^#.*/,""),{scope:!1,comments:!1,luaVersion:"5.3",encodingMode:"x-user-defined"});return(e=>{const t=[];let n=0;const r=new Map,a=(()=>{let e=0;return()=>(e+=1,e)})(),o=e=>{if(C(e)){!function(){const e=n;n=a(),r.set(n,e)}();for(let r=0;r<e.body.length;r++){const a=e.body[r];switch(a.type){case"LocalStatement":t.push({type:"local",name:a.variables[0].name,scope:n});break;case"LabelStatement":if(t.find((e=>"label"===e.type&&e.name===a.label.name&&e.scope===n)))throw new Error(`label '${a.label.name}' already defined`);t.push({type:"label",name:a.label.name,scope:n,last:"RepeatStatement"!==e.type&&e.body.slice(r).every((e=>"LabelStatement"===e.type))});break;case"GotoStatement":t.push({type:"goto",name:a.label.name,scope:n});break;case"IfStatement":a.clauses.forEach((e=>o(e)));break;default:o(a)}}n=r.get(n)}};o(e);for(let e=0;e<t.length;e++){const n=t[e];if("goto"===n.type){const r=t.filter((e=>"label"===e.type&&e.name===n.name&&e.scope<=n.scope)).sort(((e,t)=>Math.abs(n.scope-e.scope)-Math.abs(n.scope-t.scope)))[0];if(!r)throw new Error(`no visible label '${n.name}' for <goto>`);const a=t.findIndex((e=>e===r));if(a>e){const o=t.slice(e,a).filter((e=>"local"===e.type&&e.scope===r.scope));if(!r.last&&o.length>0)throw new Error(`<goto ${n.name}> jumps into the scope of local '${o[0].name}'`)}}}})(n),(e=>{let t=0,n=0;const r=(e,a,o)=>{let s=a,i=o;C(e)?((-1!==e.body.findIndex((e=>"LocalStatement"===e.type||"FunctionDeclaration"===e.type&&e.isLocal))||"FunctionDeclaration"===e.type&&(e.parameters.length>0||e.identifier&&"MemberExpression"===e.identifier.type)||"ForNumericStatement"===e.type||"ForGenericStatement"===e.type)&&(t+=1,s=t,D.set(e,t),j.set(t,a)),-1!==e.body.findIndex((e=>"LabelStatement"===e.type||"GotoStatement"===e.type))&&(i=n,G.set(e,n),"Chunk"!==e.type&&"FunctionDeclaration"!==e.type&&U.set(n,o),n+=1)):"Identifier"!==e.type&&"VarargLiteral"!==e.type||D.set(e,a),((e,t,n,r,a)=>{const o=(e,o=!0)=>{if(!e)return;const s=!1===o&&r?j.get(n):n;Array.isArray(e)?e.forEach((e=>t(e,s,a))):t(e,s,a)};switch(e.type){case"LocalStatement":case"AssignmentStatement":o(e.variables),o(e.init);break;case"UnaryExpression":o(e.argument);break;case"BinaryExpression":case"LogicalExpression":o(e.left),o(e.right);break;case"FunctionDeclaration":o(e.identifier,!1),o(e.parameters),o(e.body);break;case"ForGenericStatement":o(e.variables),o(e.iterators,!1),o(e.body);break;case"IfClause":case"ElseifClause":case"WhileStatement":case"RepeatStatement":o(e.condition,!1);case"Chunk":case"ElseClause":case"DoStatement":o(e.body);break;case"ForNumericStatement":o(e.variable),o(e.start,!1),o(e.end,!1),o(e.step,!1),o(e.body);break;case"ReturnStatement":o(e.arguments);break;case"IfStatement":o(e.clauses);break;case"MemberExpression":o(e.base),o(e.identifier);break;case"IndexExpression":o(e.base),o(e.index);break;case"LabelStatement":o(e.label);break;case"CallStatement":o(e.expression);break;case"GotoStatement":o(e.label);break;case"TableConstructorExpression":o(e.fields);break;case"TableKey":case"TableKeyString":o(e.key);case"TableValue":o(e.value);break;case"CallExpression":case"TableCallExpression":o(e.base),o(e.arguments);break;case"StringCallExpression":o(e.base),o(e.argument)}})(e,r,s,a!==s,i)};r(e,t,n)})(n),M(n).toString()},R={"([^a-zA-Z0-9%(])-":"$1*?","([^%])-([^a-zA-Z0-9?])":"$1*?$2","([^%])\\.":"$1[\\s\\S]","(.)-$":"$1*?","%a":"[a-zA-Z]","%A":"[^a-zA-Z]","%c":"[\0-]","%C":"[^\0-]","%d":"\\d","%D":"[^d]","%l":"[a-z]","%L":"[^a-z]","%p":"[.,\"'?!;:#$%&()*+-/<>=@\\[\\]\\\\^_{}|~]","%P":"[^.,\"'?!;:#$%&()*+-/<>=@\\[\\]\\\\^_{}|~]","%s":"[ \\t\\n\\f\\v\\r]","%S":"[^ \t\n\f\v\r]","%u":"[A-Z]","%U":"[^A-Z]","%w":"[a-zA-Z0-9]","%W":"[^a-zA-Z0-9]","%x":"[a-fA-F0-9]","%X":"[^a-fA-F0-9]","%([^a-zA-Z])":"\\$1"};function q(e){let t=e.replace(/\\/g,"\\\\");for(const e in R)S(R,e)&&(t=t.replace(new RegExp(e,"g"),R[e]));let n=0;for(let e=0,r=t.length;e<r;e++){if(e&&"\\"===t.substr(e-1,1))continue;const a=t.substr(e,1);"["!==a&&"]"!==a||("]"===a&&(n-=1),n>0&&(t=t.substr(0,e)+t.substr(e+1),e-=1,r-=1),"["===a&&(n+=1))}return t}const P=new i({byte:function(e,t,n){const r=y(e,"byte",1),a=void 0===t?1:v(t,"byte",2),o=void 0===n?a:v(n,"byte",3);return r.substring(a-1,o).split("").map((e=>e.charCodeAt(0)))},char:function(...e){return e.map(((e,t)=>{const n=v(e,"char",t);return String.fromCharCode(n)})).join("")},find:function(e,t,n,r){const a=y(e,"find",1),o=y(t,"find",2),s=void 0===n?1:v(n,"find",3);if(void 0===r||!v(r,"find",4)){const e=new RegExp(q(o)),t=a.substr(s-1).search(e);if(t<0)return;const n=a.substr(s-1).match(e),r=[t+s,t+s+n[0].length-1];return n.shift(),[...r,...n]}const i=a.indexOf(o,s-1);return-1===i?void 0:[i+1,i+o.length]},format:function(e,...t){let n=-1;return e.replace(/%%|%([-+ #0]*)?(\d*)?(?:\.(\d*))?(.)/g,((e,r,a,i,c)=>{if("%%"===e)return"%";if(!c.match(/[AEGXacdefgioqsux]/))throw new s(`invalid option '%${e}' to 'format'`);if(r&&r.length>5)throw new s("invalid format (repeated flags)");if(a&&a.length>2)throw new s("invalid format (width too long)");if(i&&i.length>2)throw new s("invalid format (precision too long)");n+=1;const l=t[n];if(void 0===l)throw new s(`bad argument #${n} to 'format' (no value)`);return/A|a|E|e|f|G|g/.test(c)||/c|d|i|o|u|X|x/.test(c)?o(e,v(l,"format",n)):"q"===c?`"${l.replace(/([\n"])/g,"\\$1")}"`:o(e,"s"===c?f(l):l)}))},gmatch:function(e,t){const n=y(e,"gmatch",1),r=q(y(t,"gmatch",2)),a=new RegExp(r,"g"),o=n.match(a);return()=>{const e=o.shift();if(void 0===e)return[];const t=new RegExp(r).exec(e);return t.shift(),t.length?t:[e]}},gsub:function(e,t,n,r){let a=y(e,"gsub",1);const o=void 0===r?1/0:v(r,"gsub",3),s=q(y(t,"gsub",2)),c="function"==typeof n?e=>{const t=n(e[0])[0];return void 0===t?e[0]:t}:n instanceof i?e=>n.get(e[0]).toString():e=>`${n}`.replace(/%([0-9])/g,((t,n)=>e[n]));let l,u,f="",p=0;for(;p<o&&a&&(l=a.match(s));){const e=l[0].length>0?a.substr(0,l.index):void 0===u?"":a.substr(0,1);u=l[0],f+=`${e}${c(l)}`,a=a.substr(`${e}${u}`.length),p+=1}return`${f}${a}`},len:function(e){return y(e,"len",1).length},lower:function(e){return y(e,"lower",1).toLowerCase()},match:function(e,t,n=0){let r=y(e,"match",1);const a=y(t,"match",2),o=v(n,"match",3);r=r.substr(o);const s=r.match(new RegExp(q(a)));if(s)return s[1]?(s.shift(),s):s[0]},rep:function(e,t,n){const r=y(e,"rep",1),a=v(t,"rep",2),o=void 0===n?"":y(n,"rep",3);return Array(a).fill(r).join(o)},reverse:function(e){return y(e,"reverse",1).split("").reverse().join("")},sub:function(e,t=1,n=-1){const r=y(e,"sub",1);let a=p(v(t,"sub",2),r.length),o=p(v(n,"sub",3),r.length);return a<1&&(a=1),o>r.length&&(o=r.length),a<=o?r.substr(a-1,o-a+1):""},upper:function(e){return y(e,"upper",1).toUpperCase()}}),Z=new i({__index:P});function H(e,t){if(void 0===t)throw new s("Bad argument #2 to ipairs() iterator");const n=t+1,r=e.numValues;if(r[n]&&void 0!==r[n])return[n,r[n]]}function W(e,t){if(d(e))return[e,t];const n=void 0===t?"Assertion failed!":y(t,"assert",2);throw new s(n)}function X(){return[]}function Y(e){const t=y(e,"error",1);throw new s(t)}function z(e){if(e instanceof i&&e.metatable){return e.metatable.rawget("__metatable")||e.metatable}if("string"==typeof e)return Z}function K(e){const t=x(e,"ipairs",1),n=t.getMetaMethod("__pairs")||t.getMetaMethod("__ipairs");return n?n(t).slice(0,3):[H,t,0]}function J(e,t){const n=x(e,"next",1);let r=void 0===t;if(r||"number"==typeof t&&t>0){const e=n.numValues,a=Object.keys(e);let o=1;if(!r){const e=a.indexOf(`${t}`);e>=0&&(r=!0,o+=e)}if(r)for(;void 0!==a[o];o++){const t=Number(a[o]),n=e[t];if(void 0!==n)return[t,n]}}for(const e in n.strValues)if(S(n.strValues,e))if(r){if(void 0!==n.strValues[e])return[e,n.strValues[e]]}else e===t&&(r=!0);for(const e in n.keys)if(S(n.keys,e)){const a=n.keys[e];if(r){if(void 0!==n.values[e])return[a,n.values[e]]}else a===t&&(r=!0)}}function Q(e){const t=x(e,"pairs",1),n=t.getMetaMethod("__pairs");return n?n(t).slice(0,3):[J,t,void 0]}function ee(e,...t){if("function"!=typeof e)throw new s("Attempt to call non-function");try{return[!0,...e(...t)]}catch(e){return[!1,e&&e.toString()]}}function te(e,t){return e===t}function ne(e,t){return x(e,"rawget",1).rawget(t)}function re(e){if(e instanceof i)return e.getn();if("string"==typeof e)return e.length;throw new s("attempt to get length of an unsupported value")}function ae(e,t,n){const r=x(e,"rawset",1);if(void 0===t)throw new s("table index is nil");return r.rawset(t,n),r}function oe(e,...t){if("#"===e)return t.length;if("number"==typeof e){const n=p(Math.trunc(e),t.length);return t.slice(n-1)}throw new s(`bad argument #1 to 'select' (number expected, got ${u(e)})`)}function se(e,t){const n=x(e,"setmetatable",1);if(n.metatable&&n.metatable.rawget("__metatable"))throw new s("cannot change a protected metatable");return n.metatable=null==t?null:x(t,"setmetatable",2),n}function ie(e,t){const n=b(e).trim(),r=void 0===t?10:v(t,"tonumber",2);if(10!==r&&"nil"===n)throw new s("bad argument #1 to 'tonumber' (string expected, got nil)");if(r<2||r>36)throw new s("bad argument #2 to 'tonumber' (base out of range)");if(""!==n)return 10===r?g(n):new RegExp(`^${16===r?"(0x)?":""}[${"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".substr(0,r)}]*$`,"gi").test(n)?parseInt(n,r):void 0}function ce(e,t,...n){if("function"!=typeof e||"function"!=typeof t)throw new s("Attempt to call non-function");try{return[!0,...e(...n)]}catch(e){return[!1,t(e)[0]]}}const le=(e,t,n,r)=>{const a=e instanceof i&&e.getMetaMethod(n)||t instanceof i&&t.getMetaMethod(n);return a?a(e,t)[0]:r(g(e,"attempt to perform arithmetic on a %type value"),g(t,"attempt to perform arithmetic on a %type value"))},ue=(e,t,n,r)=>"string"==typeof e&&"string"==typeof t||"number"==typeof e&&"number"==typeof t?r(e,t):le(e,t,n,r),fe=e=>d(e),pe=(e,t)=>{const n=t!==e&&e instanceof i&&t instanceof i&&e.metatable===t.metatable&&e.getMetaMethod("__eq");return n?!!n(e,t)[0]:e===t},he=(e,t)=>ue(e,t,"__lt",((e,t)=>e<t)),de=(e,t)=>ue(e,t,"__le",((e,t)=>e<=t)),ge={bool:fe,and:(e,t)=>d(e)?t:e,or:(e,t)=>d(e)?e:t,not:e=>!fe(e),unm:e=>{const t=e instanceof i&&e.getMetaMethod("__unm");return t?t(e)[0]:-1*g(e,"attempt to perform arithmetic on a %type value")},bnot:e=>{const t=e instanceof i&&e.getMetaMethod("__bnot");return t?t(e)[0]:~g(e,"attempt to perform arithmetic on a %type value")},len:e=>{if(e instanceof i){const t=e.getMetaMethod("__len");return t?t(e)[0]:e.getn()}if("string"==typeof e)return e.length;throw new s("attempt to get length of an unsupported value")},add:(e,t)=>le(e,t,"__add",((e,t)=>e+t)),sub:(e,t)=>le(e,t,"__sub",((e,t)=>e-t)),mul:(e,t)=>le(e,t,"__mul",((e,t)=>e*t)),mod:(e,t)=>le(e,t,"__mod",((e,t)=>{if(0===t||t===-1/0||t===1/0||isNaN(e)||isNaN(t))return NaN;const n=Math.abs(t);let r=Math.abs(e)%n;return e*t<0&&(r=n-r),t<0&&(r*=-1),r})),pow:(e,t)=>le(e,t,"__pow",Math.pow),div:(e,t)=>le(e,t,"__div",((e,t)=>{if(void 0===t)throw new s("attempt to perform arithmetic on a nil value");return e/t})),idiv:(e,t)=>le(e,t,"__idiv",((e,t)=>{if(void 0===t)throw new s("attempt to perform arithmetic on a nil value");return Math.floor(e/t)})),band:(e,t)=>le(e,t,"__band",((e,t)=>e&t)),bor:(e,t)=>le(e,t,"__bor",((e,t)=>e|t)),bxor:(e,t)=>le(e,t,"__bxor",((e,t)=>e^t)),shl:(e,t)=>le(e,t,"__shl",((e,t)=>e<<t)),shr:(e,t)=>le(e,t,"__shr",((e,t)=>e>>t)),concat:(e,t)=>{const n=e instanceof i&&e.getMetaMethod("__concat")||t instanceof i&&t.getMetaMethod("__concat");return n?n(e,t)[0]:`${b(e,"attempt to concatenate a %type value")}${b(t,"attempt to concatenate a %type value")}`},neq:(e,t)=>!pe(e,t),eq:pe,lt:he,le:de,gt:(e,t)=>!de(e,t),ge:(e,t)=>!he(e,t)},be=Number.MAX_SAFE_INTEGER,me=Number.MIN_SAFE_INTEGER,ve=Math.PI;let ye=1;function xe(){return ye=16807*ye%2147483647,ye/2147483647}function we(e,t){const n=v(e,"atan",1),r=void 0===t?1:v(t,"atan",2);return Math.atan2(n,r)}function Se(e){const t=v(e,"exp",1);return Math.exp(t)}function $e(e){const t=g(e);if(void 0!==t)return Math.floor(t)}const Ce=new i({abs:function(e){const t=v(e,"abs",1);return Math.abs(t)},acos:function(e){const t=v(e,"acos",1);return Math.acos(t)},asin:function(e){const t=v(e,"asin",1);return Math.asin(t)},atan:we,atan2:function(e,t){return we(e,t)},ceil:function(e){const t=v(e,"ceil",1);return Math.ceil(t)},cos:function(e){const t=v(e,"cos",1);return Math.cos(t)},cosh:function(e){const t=v(e,"cosh",1);return(Se(t)+Se(-t))/2},deg:function(e){return 180*v(e,"deg",1)/Math.PI},exp:Se,floor:function(e){const t=v(e,"floor",1);return Math.floor(t)},fmod:function(e,t){return v(e,"fmod",1)%v(t,"fmod",2)},frexp:function(e){let t=v(e,"frexp",1);if(0===t)return[0,0];const n=t>0?1:-1;t*=n;const r=Math.floor(Math.log(t)/Math.log(2))+1;return[t/Math.pow(2,r)*n,r]},huge:1/0,ldexp:function(e,t){const n=v(e,"ldexp",1),r=v(t,"ldexp",2);return n*Math.pow(2,r)},log:function(e,t){const n=v(e,"log",1);if(void 0===t)return Math.log(n);{const e=v(t,"log",2);return Math.log(n)/Math.log(e)}},log10:function(e){const t=v(e,"log10",1);return Math.log(t)/Math.log(10)},max:function(...e){const t=e.map(((e,t)=>v(e,"max",t+1)));return Math.max(...t)},min:function(...e){const t=e.map(((e,t)=>v(e,"min",t+1)));return Math.min(...t)},maxinteger:be,mininteger:me,modf:function(e){const t=v(e,"modf",1),n=Math.floor(t);return[n,t-n]},pi:ve,pow:function(e,t){const n=v(e,"pow",1),r=v(t,"pow",2);return Math.pow(n,r)},rad:function(e){const t=v(e,"rad",1);return Math.PI/180*t},random:function(e,t){if(void 0===e&&void 0===t)return xe();const n=v(e,"random",1),r=void 0!==t?n:1,a=void 0!==t?v(t,"random",2):n;if(r>a)throw new Error("bad argument #2 to 'random' (interval is empty)");return Math.floor(xe()*(a-r+1)+r)},randomseed:function(e){ye=v(e,"randomseed",1)},sin:function(e){const t=v(e,"sin",1);return Math.sin(t)},sinh:function(e){const t=v(e,"sinh",1);return(Se(t)-Se(-t))/2},sqrt:function(e){const t=v(e,"sqrt",1);return Math.sqrt(t)},tan:function(e){const t=v(e,"tan",1);return Math.tan(t)},tanh:function(e){const t=v(e,"tanh",1);return(Se(t)-Se(-t))/(Se(t)+Se(-t))},tointeger:$e,type:function(e){const t=g(e);if(void 0!==t)return $e(t)===t?"integer":"float"},ult:function(e,t){const n=v(e,"ult",1),r=v(t,"ult",2),a=e=>e>>>0;return a(n)<a(r)}});function Ee(e){return x(e,"maxn",1).numValues.length-1}const ke=new i({getn:function(e){return x(e,"getn",1).getn()},concat:function(e,t="",n=1,r){const a=x(e,"concat",1),o=y(t,"concat",2),s=v(n,"concat",3),i=void 0===r?Ee(a):v(r,"concat",4);return[].concat(a.numValues).splice(s,i-s+1).join(o)},insert:function(e,t,n){const r=x(e,"insert",1),a=void 0===n?r.numValues.length:v(t,"insert",2),o=void 0===n?t:n;r.numValues.splice(a,0,void 0),r.set(a,o)},maxn:Ee,move:function(e,t,n,r,a){const o=x(e,"move",1),i=v(t,"move",2),c=v(n,"move",3),l=v(r,"move",4),u=void 0===a?o:x(a,"move",5);if(c>=i){if(i<=0&&c>=Number.MAX_SAFE_INTEGER+i)throw new s("too many elements to move");const e=c-i+1;if(l>Number.MAX_SAFE_INTEGER-e+1)throw new s("destination wrap around");if(l>c||l<=i||u!==o)for(let t=0;t<e;t++){const e=o.get(i+t);u.set(l+t,e)}else for(let t=e-1;t>=0;t--){const e=o.get(i+t);u.set(l+t,e)}}return u},pack:function(...e){const t=new i(e);return t.rawset("n",e.length),t},remove:function(e,t){const n=x(e,"remove",1),r=n.getn(),a=void 0===t?r:v(t,"remove",2);if(a>r||a<0)return;const o=n.numValues,s=o.splice(a,1)[0];let i=a;for(;i<r&&void 0===o[i];)delete o[i],i+=1;return s},sort:function(e,t){const n=x(e,"sort",1);let r;if(t){const e=function(e,t,n){if(e instanceof Function)return e;{const r=u(e);throw new s(`bad argument #${n} to '${t}' (function expected, got ${r})`)}}(t,"sort",2);r=(t,n)=>d(e(t,n)[0])?-1:1}else r=(e,t)=>e<t?-1:1;const a=n.numValues;a.shift(),a.sort(r).unshift(void 0)},unpack:function(e,t,n){const r=x(e,"unpack",1),a=void 0===t?1:v(t,"unpack",2),o=void 0===n?r.getn():v(n,"unpack",3);return r.numValues.slice(a,o+1)}}),Ae=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Me=["January","February","March","April","May","June","July","August","September","October","November","December"],Le=[31,28,31,30,31,30,31,31,30,31,30,31],_e={"%":()=>"%",Y:(e,t)=>`${t?e.getUTCFullYear():e.getFullYear()}`,y:(e,t)=>_e.Y(e,t).substr(-2),b:(e,t)=>_e.B(e,t).substr(0,3),B:(e,t)=>Me[t?e.getUTCMonth():e.getMonth()],m:(e,t)=>`0${(t?e.getUTCMonth():e.getMonth())+1}`.substr(-2),U:(e,t)=>Fe(e,0,t),W:(e,t)=>Fe(e,1,t),j:(e,t)=>{let n=t?e.getUTCDate():e.getDate();const r=t?e.getUTCMonth():e.getMonth(),a=t?e.getUTCFullYear():e.getFullYear();return n+=Le.slice(0,r).reduce(((e,t)=>e+t),0),r>1&&a%4==0&&(n+=1),`00${n}`.substr(-3)},d:(e,t)=>`0${t?e.getUTCDate():e.getDate()}`.substr(-2),a:(e,t)=>_e.A(e,t).substr(0,3),A:(e,t)=>Ae[t?e.getUTCDay():e.getDay()],w:(e,t)=>`${t?e.getUTCDay():e.getDay()}`,H:(e,t)=>`0${t?e.getUTCHours():e.getHours()}`.substr(-2),I:(e,t)=>`0${(t?e.getUTCHours():e.getHours())%12||12}`.substr(-2),M:(e,t)=>`0${t?e.getUTCMinutes():e.getMinutes()}`.substr(-2),S:(e,t)=>`0${t?e.getUTCSeconds():e.getSeconds()}`.substr(-2),c:(e,t)=>e.toLocaleString(void 0,t?{timeZone:"UTC"}:void 0),x:(e,t)=>`${_e.m(e,t)}/${_e.d(e,t)}/${_e.y(e,t)}`,X:(e,t)=>`${_e.H(e,t)}:${_e.M(e,t)}:${_e.S(e,t)}`,p:(e,t)=>(t?e.getUTCHours():e.getHours())<12?"AM":"PM",Z:(e,t)=>{if(t)return"UTC";const n=e.toString().match(/[A-Z][A-Z][A-Z]/);return n?n[0]:""}};function Oe(e){const t=e.getFullYear(),n=new Date(t,0);return e.getTimezoneOffset()!==n.getTimezoneOffset()}function Fe(e,t,n){const r=parseInt(_e.j(e,n),10),a=new Date(e.getFullYear(),0,1,12),o=(8-(n?a.getUTCDay():a.getDay())+t)%7;return`0${Math.floor((r-o)/7)+1}`.substr(-2)}function Ie(e="%c",t){const n="!"===e.substr(0,1),r=n?e.substr(1):e,a=new Date;return t&&a.setTime(1e3*t),"*t"===r?new i({year:parseInt(_e.Y(a,n),10),month:parseInt(_e.m(a,n),10),day:parseInt(_e.d(a,n),10),hour:parseInt(_e.H(a,n),10),min:parseInt(_e.M(a,n),10),sec:parseInt(_e.S(a,n),10),wday:parseInt(_e.w(a,n),10)+1,yday:parseInt(_e.j(a,n),10),isdst:Oe(a)}):r.replace(/%[%YybBmUWjdaAwHIMScxXpZ]/g,(e=>_e[e[1]](a,n)))}function Ne(e="C"){if("C"===e)return"C"}function Te(e){let t=Math.round(Date.now()/1e3);if(!e)return t;const n=e.rawget("year"),r=e.rawget("month"),a=e.rawget("day"),o=e.rawget("hour")||12,s=e.rawget("min"),i=e.rawget("sec");return n&&(t+=31557600*n),r&&(t+=2629800*r),a&&(t+=86400*a),o&&(t+=3600*o),s&&(t+=60*s),i&&(t+=i),t}function Ve(e,t){return v(e,"difftime",1)-v(t,"difftime",2)}const je=(e,...t)=>{if(e instanceof Function)return w(e(...t));const n=e instanceof i&&e.getMetaMethod("__call");if(n)return w(n(e,...t));throw new s("attempt to call an uncallable type")},De=new i;De.metatable=Z;const Ue=(e,t)=>{if(e instanceof i)return e.get(t);if("string"==typeof e)return De.get(t);throw new s("no table or metatable found for given type")},Ge=(e,t,n)=>{const r=new Function("__lua",t),a=new $(e.strValues).extend();n&&a.setVarargs([n]);const o=r(Object.assign(Object.assign({globalScope:a},ge),{Table:i,call:je,get:Ue}));return void 0===o?[void 0]:o},Be=class{constructor(e,t,n){this.r=e,this.g=t,this.b=n}toString(){return"rgb("+this.r.toString()+" "+this.g.toString()+" "+this.b.toString()+")"}},Re=class{constructor(){this.width=240,this.height=180,this.gfxScale=4,this.fps=60,this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=this.width*this.gfxScale,this.canvas.height=this.height*this.gfxScale,this.curColor=this.RGB(0,0,0),this.offsetX=0,this.offsetY=0,this.scrnBuffer=[];for(let e=0;e<this.height;e++){this.scrnBuffer[e]=[];for(let t=0;t<this.width;t++)this.scrnBuffer[e][t]=this.RGB(0,0,0)}console.log("Hello World"),document.body.insertBefore(this.canvas,document.body.childNodes[0]),setInterval(this.tick(),1e3/this.fps),console.log("interval set")}tick(){this.update(),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.draw();for(let e=0;e<this.height;e++)for(let t=0;t<this.width;t++)this.context.fillStyle=this.scrnBuffer[e][t].toString(),this.context.fillRect(t*this.gfxScale,e*this.gfxScale,this.gfxScale,this.gfxScale)}cls(e=this.RGB(0,0,0)){this.cam(0,0),this.color(e);for(let t=0;t<this.height;t++)for(let n=0;n<this.width;n++)this.pset(n,t,e)}rectFill(e,t,n,r){for(let a=0;a<r;a++)for(let r=0;r<n;r++)this.pset(r+e,a+t)}rectStrk(e,t,n,r){for(let a=0;a<r;a++)for(let o=0;o<n;o++)0!=o&&0!=a&&o!=n-1&&a!=r-1||this.pset(o+e,a+t)}pset(e,t){e-=this.offsetX,t-=this.offsetY,e>=0&&e<this.width&&t>=0&&t<this.height&&(this.scrnBuffer[t][e]=this.curColor)}RGB(e,t,n){return new Be(e,t,n)}color(e){this.curColor=e}cam(e,t){this.offsetX=e,this.offsetY=t}update(){}draw(){}},qe=function(e={}){const t=Object.assign({LUA_PATH:"./?.lua",stdin:"",stdout:console.log},e),n=function(e,t){function n(e,n,r,o){let s,i="";if(e instanceof Function){let t=" ";for(;""!==t&&void 0!==t;)i+=t,t=e()[0]}else i=y(e,"load",1);try{s=B(i)}catch(e){return[void 0,e.message]}return()=>t(o||a,s)}function r(t,r,a){const o=void 0===t?e.stdin:y(t,"loadfile",1);if(!e.fileExists)throw new s("loadfile requires the config.fileExists function");if(!e.fileExists(o))return[void 0,"file not found"];if(!e.loadFile)throw new s("loadfile requires the config.loadFile function");return n(e.loadFile(o),0,0,a)}const a=new i({_VERSION:"Lua 5.3",assert:W,dofile:function(e){const t=r(e);if(Array.isArray(t)&&void 0===t[0])throw new s(t[1]);return t()},collectgarbage:X,error:Y,getmetatable:z,ipairs:K,load:n,loadfile:r,next:J,pairs:Q,pcall:ee,print:function(...t){const n=t.map((e=>f(e))).join("\t");e.stdout(n)},rawequal:te,rawget:ne,rawlen:re,rawset:ae,select:oe,setmetatable:se,tonumber:ie,tostring:f,type:u,xpcall:ce});return a}(t,Ge),{libPackage:r,_require:a}=((e,t)=>{const r=t.LUA_PATH,a=["/",";","?","!","-"].join("\n"),o=new i,c=new i,l=(e,n,r,a)=>{if(!t.fileExists)throw new s("package.searchpath requires the config.fileExists function");let o=y(e,"searchpath",1);const i=y(n,"searchpath",2),c=void 0===r?".":y(r,"searchpath",3),l=void 0===a?"/":y(a,"searchpath",4);o=o.replace(c,l);const u=i.split(";").map((e=>e.replace("?",o)));for(const e of u)if(t.fileExists(e))return e;return[void 0,`The following files don't exist: ${u.join(" ")}`]},u=new i([e=>{const t=c.rawget(e);return void 0===t?[void 0]:[t]},e=>{const r=l(e,f.rawget("path"));if(Array.isArray(r)&&void 0===r[0])return[r[1]];if(!t.loadFile)throw new s("package.searchers requires the config.loadFile function");return[(e,r)=>((e,t)=>Ge(n,B(e),t)[0])(t.loadFile(r),e),r]}]),f=new i({path:r,config:a,loaded:o,preload:c,searchers:u,searchpath:l});return{libPackage:f,_require:function(e){const t=y(e,"require",1),n=o.rawget(t);if(n)return n;const r=u.numValues.filter((e=>!!e));for(const e of r){const n=e(t);if(void 0!==n[0]&&"string"!=typeof n[0]){const e=(0,n[0])(t,n[1]),r=void 0===e||e;return o.rawset(t,r),r}}throw new s(`Module '${t}' not found!`)}}})(0,t),o=r.get("loaded"),c=(e,t)=>{n.rawset(e,t),o.rawset(e,t)};c("_G",n),c("package",r),c("math",Ce),c("table",ke),c("string",P),c("os",(e=>new i({date:Ie,exit:function(t){if(!e.osExit)throw new s("os.exit requires the config.osExit function");let n=0;"boolean"==typeof t&&!1===t?n=1:"number"==typeof t&&(n=t),e.osExit(n)},setlocale:Ne,time:Te,difftime:Ve}))(t)),n.rawset("require",a);const l=e=>{const t=B(e);return{exec:()=>Ge(n,t)[0]}};return{parse:l,parseFile:e=>{if(!t.fileExists)throw new s("parseFile requires the config.fileExists function");if(!t.loadFile)throw new s("parseFile requires the config.loadFile function");if(!t.fileExists(e))throw new s("file not found");return l(t.loadFile(e))},loadLib:c}}();qe.parse("print('hallloooooo')").exec(),new class extends Re{constructor(){super()}update(){}draw(){this.cls(this.RGB(0,0,0)),this.cam(0,0),this.color(this.RGB(255,0,0)),this.rectFill(0,0,16,16),this.color(this.RGB(0,255,0)),this.rectStrk(0,0,16,16)}}})()})();